# CTF Web 学习笔记 - 2026.01.02

> 今日刷题：14 道 | 平台：华云 + NSSCTF

---

## 一、信息泄露 (华云 xxxl1-8)

### xxxl1 - 源码注释泄露

**题目地址**: https://my6n.huayunsys.com/games/1/challenges#68-xxxl1

**解题过程**:

1. 打开网页，看到 "Imaginarium" 前端展示页面
2. F12 打开开发者工具，查看 Elements
3. 发现 HTML 注释中包含 flag：

```html
<!--
secret: flag{b5acbcb1-2503-4952-a846-b40c8994b27f}
Hint: View page source (右键 → 查看源代码) or Inspect to find more easter-eggs.
-->
```

4. body 标签还有隐藏属性：`<body data-secret="flag-hidden-1">`

**Flag**: `flag{b5acbcb1-2503-4952-a846-b40c8994b27f}`

**知识点**:

查看源码的多种方式：
| 方法 | 操作 | 说明 |
|------|------|------|
| 右键菜单 | 右键 → 查看页面源代码 | 可能被 JS 禁用 |
| 快捷键 | `Ctrl+U` / `Cmd+Option+U` | 不受 JS 影响 |
| 地址栏 | `view-source:http://xxx` | 最可靠的方式 |
| F12 | 开发者工具 → Elements | 可以看到动态生成的内容 |

常见注释泄露：
```html
<!-- TODO: 删除这个测试账号 admin/123456 -->
<!-- DEBUG: API_KEY=xxxxx -->
/* 数据库：mysql://root:root@localhost/db */
```

---

### xxxl2 - phpinfo 信息泄露

**解题过程**:

1. 打开页面，发现是 `phpinfo()` 输出
2. `Ctrl+F` 搜索 "flag"
3. 在 `$_SERVER` 部分找到：

```
$_SERVER['GZCTF_FLAG'] = flag{a24a552b-48ec-4161-bb92-69c596e5a67d}
```

**Flag**: `flag{a24a552b-48ec-4161-bb92-69c596e5a67d}`

**知识点**:

phpinfo() 泄露的危害：
| 信息类型 | 泄露内容 | 危害 |
|----------|----------|------|
| PHP 版本 | `PHP Version 7.4.3` | 可针对性找漏洞 |
| 系统信息 | `Linux xxx 5.4.0` | 确定操作系统 |
| 网站路径 | `DOCUMENT_ROOT: /var/www/html` | 确定 Web 根目录 |
| 环境变量 | `$_ENV`, `$_SERVER` | 可能包含密钥、密码 |
| disabled_functions | `system,exec,shell_exec` | 确定禁用函数 |

常见 phpinfo 路径：
```
/phpinfo.php
/info.php
/test.php
/i.php
/?phpinfo=1
```

搜索关键词：`flag`, `password`, `secret`, `key`, `DOCUMENT_ROOT`, `disable_functions`

---

### xxxl3 - robots.txt 泄露

**解题过程**:

1. 访问 `/robots.txt`：
```
disallow: f14ggggggggggg.txt
```

2. 访问 `/f14ggggggggggg.txt`

**Flag**: `flag{62b916b6-c985-4a31-b673-a43c0e9a098f}`

**知识点**:

robots.txt 是什么？
```
网站根目录下的爬虫协议文件
告诉搜索引擎哪些页面可以抓取，哪些不可以
但这只是"君子协议"，攻击者可以忽略
```

标准格式：
```txt
User-agent: *
Disallow: /admin/
Disallow: /backup/
Sitemap: https://example.com/sitemap.xml
```

CTF 中 Disallow 的路径往往就是 flag 所在！

---

### xxxl4 - 源码压缩包泄露

**解题过程**:

1. 尝试常见备份文件名，下载 `www.zip`
2. 解压后查看 `index.php`：

```php
<?php
echo "flag is here!";
//flag{696ce6f6-7ce2-4e0f-9154-d6892c74b5d8};
?>
```

**Flag**: `flag{696ce6f6-7ce2-4e0f-9154-d6892c74b5d8}`

**知识点**:

常见备份文件名：
| 类型 | 文件名 |
|------|--------|
| 压缩包 | `www.zip`, `web.zip`, `backup.zip`, `html.zip` |
| 压缩包 | `wwwroot.zip`, `website.tar.gz` |
| 数据库 | `backup.sql`, `dump.sql`, `db.sql` |
| 单文件 | `index.php.bak`, `index.php~` |
| Vim | `.index.php.swp`, `.index.php.swo` |

为什么会泄露？
```bash
# 错误做法：在 Web 目录打包
cd /var/www/html
zip -r www.zip ./*

# 正确做法：放到 Web 目录外
zip -r /opt/backup/www.zip /var/www/html/
```

---

### xxxl5 - 302 重定向泄露

**解题过程**:

1. 访问页面，发现自动跳转
2. F12 → Network → 刷新页面
3. 查看第一个请求（302 状态码）
4. 在响应头或响应体中找到 flag

**知识点**:

为什么重定向会泄露？

```php
<?php
// 漏洞代码
$flag = "flag{xxx}";
echo $flag;                      // 先输出了 flag
header("Location: /login.php");  // 再重定向
// 浏览器跳转了，但响应体已经发送

// 正确写法
header("Location: /login.php");
exit();  // 必须 exit！
?>
```

捕获方法：
```bash
# curl 不跟随跳转
curl http://target.com/

# curl 只看响应头
curl -I http://target.com/

# F12 Network 查看 302 响应
```

---

### xxxl6 - .git 泄露

**解题过程**:

1. 访问 `/.git/config` 确认存在
2. 使用 GitHack 下载源码：
```bash
python GitHack.py http://target.com/.git/
```
3. 在恢复的源码中找到 flag

**知识点**:

.git 目录结构：
```
.git/
├── config          # 仓库配置
├── HEAD            # 当前分支指针
├── index           # 暂存区
├── objects/        # Git 对象
├── refs/           # 引用
└── logs/           # 操作日志
```

利用工具：
```bash
# GitHack
python GitHack.py http://target.com/.git/

# git-dumper（更强大）
pip install git-dumper
git-dumper http://target.com/.git/ output_dir
```

查看历史提交：
```bash
cd output_dir
git log --all                    # 查看所有提交
git show <commit_hash>           # 查看某次提交
git diff HEAD~1                  # 对比上一次提交
```

---

### xxxl7 - .DS_Store 泄露

**知识点**:

什么是 .DS_Store？
```
macOS 系统自动生成的隐藏文件
存储目录的自定义属性
里面包含了目录下的文件列表！
```

利用工具：
```bash
git clone https://github.com/lijiejie/ds_store_exp.git
python ds_store_exp.py http://target.com/.DS_Store
```

---

### xxxl8 - 目录扫描

**解题过程**:

1. 访问 `/robots.txt`：
```
User-agent: *
Disallow: test.php

have fun with my test!
try scan me!
```

2. 提示 "try scan me" → 需要目录扫描
3. 使用 dirsearch：
```bash
python dirsearch.py -u http://target.com/ -e php,txt,html
```
4. 找到隐藏文件获取 flag

**知识点**:

常用目录扫描工具：
| 工具 | 命令 |
|------|------|
| dirsearch | `python dirsearch.py -u url -e php` |
| dirb | `dirb http://url wordlist.txt` |
| gobuster | `gobuster dir -u url -w wordlist.txt` |
| ffuf | `ffuf -u url/FUZZ -w wordlist.txt` |

dirsearch 常用参数：
```bash
python dirsearch.py -u http://target.com -e php,txt,html,zip
python dirsearch.py -u http://target.com -w /path/to/wordlist.txt
python dirsearch.py -u http://target.com -t 50  # 50线程
python dirsearch.py -u http://target.com -r     # 递归
```

---

## 二、JS 分析 (NSSCTF)

### 导弹迷踪

**解题过程**:

1. F12 打开开发者工具
2. Sources/Network 找到 game.js
3. 搜索 "flag"、"score"、"win"
4. 找到判断条件，控制台执行

**技巧**:
```javascript
// 控制台修改变量
score = 99999

// 直接调用获胜函数
win()
gameover()
```

---

### 1zjs (JSFuck)

**解题过程**:

1. 查看源码，发现 `./dist/index.umd.js`
2. 分析 JS，找到提示：`Your gift just take it : /f@k3f1ag.php`
3. 访问得到 JSFuck 编码（只有 `[]()!+` 符号）
4. 控制台直接执行或用解码器

**Flag**: `NSSCTF{c64abefc-73d3-4f0b-8f83-9f3588c2dc5e}`

**知识点**:

JSFuck 原理：
```javascript
// 只用 6 个字符: []()!+
![]         // false
!![]        // true
+!![]       // 1

// "a" = "false"[1]
(![]+[])[+!+[]]
```

解码方法：
- 浏览器控制台直接执行
- 在线解码器 jsfuck.com

---

## 三、暴力破解 (华云 blpj1-4)

### blpj1 - 基础爆破

**解题思路**:

1. 登录页面，用户名是 0-5 的数字
2. Burp Suite Intruder → Cluster bomb
3. username: Numbers 0-5，password: 字典
4. 观察 Length 不同的就是正确的

**配置**:
```python
payloads = {
    "USER": {"type": "range", "start": 0, "end": 5},
    "PASS": {"type": "file", "path": "top50k.txt"}
}
```

---

### blpj2 / blpj4 - 多参数爆破

和 blpj1 类似，根据题目提示调整参数范围。

---

### blpj3 - Payload 处理（Base64）

**解题思路**:

观察 Burp 的 Payload Processing：
1. Add Prefix: `admin:`
2. Base64-encode

处理流程：
```
123456 → admin:123456 → YWRtaW46MTIzNDU2
```

**Burp 配置**:
```
Intruder → Payloads → Payload Processing
1. Add rule: Add Prefix → admin:
2. Add rule: Encode → Base64-encode
```

**Python 配置**:
```python
payloads = {
    "PASS": {
        "type": "file",
        "path": "top50k.txt",
        "processors": [
            P.prefix("admin:"),
            P.base64_encode()
        ]
    }
}
```

---

### Burp vs Python 速度对比

| 工具 | 并发数 | 速度 |
|------|--------|------|
| Burp Suite | 10-50 | ~100/s |
| Python 异步 | 300-500 | 2000+/s |

提高 Burp 速度：
```
Intruder → Resource Pool → 新建池
Maximum concurrent requests: 50-100
```

---

## 四、信息泄露检测清单

```bash
# 必查路径
/robots.txt
/.git/config
/.svn/entries
/.DS_Store
/phpinfo.php
/www.zip
/backup.zip
/index.php.bak
```

---

## 五、今日总结

```
✅ 信息泄露：源码注释、phpinfo、robots.txt、备份文件、302重定向、.git、目录扫描
✅ JS 分析：源码审计、JSFuck 解码
✅ 暴力破解：多参数爆破、Payload 处理（Base64）
```

